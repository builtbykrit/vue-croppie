!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VueCroppie={})}(this,function(e){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var i,n=(function(e,i){var n,o;n=t,o=function(t){"function"!=typeof Promise&&function(t){function i(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],h(e,i(r,this),i(a,this))}function o(e){var t=this;return null===this._state?void this._deferreds.push(e):void c(function(){var i=t._state?e.onFulfilled:e.onRejected;if(null!==i){var n;try{n=i(t._value)}catch(t){return void e.reject(t)}e.resolve(n)}else(t._state?e.resolve:e.reject)(t._value)})}function r(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void h(i(t,e),i(r,this),i(a,this))}this._state=!0,this._value=e,s.call(this)}catch(e){a.call(this,e)}}function a(e){this._state=!1,this._value=e,s.call(this)}function s(){for(var e=0,t=this._deferreds.length;t>e;e++)o.call(this,this._deferreds[e]);this._deferreds=null}function l(e,t,i,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=i,this.reject=n}function h(e,t,i){var n=!1;try{e(function(e){n||(n=!0,t(e))},function(e){n||(n=!0,i(e))})}catch(e){if(n)return;n=!0,i(e)}}var u=setTimeout,c="function"==typeof setImmediate&&setImmediate||function(e){u(e,1)},p=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var i=this;return new n(function(n,r){o.call(i,new l(e,t,n,r))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&p(arguments[0])?arguments[0]:arguments);return new n(function(t,i){function n(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){n(r,e)},i)}e[r]=a,0==--o&&t(e)}catch(e){i(e)}}if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)n(r,e[r])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,i){i(e)})},n.race=function(e){return new n(function(t,i){for(var n=0,o=e.length;o>n;n++)e[n].then(t,i)})},n._setImmediateFn=function(e){c=e},e.exports?e.exports=n:t.Promise||(t.Promise=n)}(this),"function"!=typeof window.CustomEvent&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,i){for(var n=atob(this.toDataURL(t,i).split(",")[1]),o=n.length,r=new Uint8Array(o),a=0;a<o;a++)r[a]=n.charCodeAt(a);e(new Blob([r],{type:t||"image/png"}))}});var i,n,o,r=["Webkit","Moz","ms"],a=document.createElement("div").style,s=[1,8,3,6],l=[2,7,4,5];function h(e){if(e in a)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=r.length;i--;)if((e=r[i]+t)in a)return e}function u(e,t){for(var i in e=e||{},t)t[i]&&t[i].constructor&&t[i].constructor===Object?(e[i]=e[i]||{},u(e[i],t[i])):e[i]=t[i];return e}function c(e){return u({},e)}function p(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function d(e,t,i){if("string"==typeof t){var n=t;(t={})[n]=i}for(var o in t)e.style[o]=t[o]}function m(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function f(e,t){for(var i in t)e.setAttribute(i,t[i])}function v(e){return parseInt(e,10)}function g(e,t){var i=e.naturalWidth,n=e.naturalHeight,o=t||x(e);if(o&&o>=5){var r=i;i=n,n=r}return{width:i,height:n}}n=h("transform"),i=h("transformOrigin"),o=h("userSelect");var w={translate3d:{suffix:", 0px"},translate:{suffix:""}},y=function(e,t,i){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(i)};y.parse=function(e){return e.style?y.parse(e.style[n]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?y.fromMatrix(e):y.fromString(e)},y.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new y(v(t[4]),v(t[5]),parseFloat(t[0]))},y.fromString=function(e){var t=e.split(") "),i=t[0].substring(V.globals.translate.length+1).split(","),n=t.length>1?t[1].substring(6):1,o=i.length>1?i[0]:0,r=i.length>1?i[1]:0;return new y(o,r,n)},y.prototype.toString=function(){var e=w[V.globals.translate].suffix||"";return V.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var b=function(e){if(!e||!e.style[i])return this.x=0,void(this.y=0);var t=e.style[i].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};function x(e){return e.exifdata?e.exifdata.Orientation:1}function C(e,t,i){var n=t.width,o=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),i){case 2:r.translate(n,0),r.scale(-1,1);break;case 3:r.translate(n,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:e.width=o,e.height=n,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=o,e.height=n,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:e.width=o,e.height=n,r.rotate(-90*Math.PI/180),r.translate(-n,o),r.scale(1,-1);break;case 8:e.width=o,e.height=n,r.translate(0,n),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,n,o),r.restore()}function E(){var e,t,i,r,a,s=this.options.viewport.type?"cr-vp-"+this.options.viewport.type:null;this.options.useCanvas=this.options.enableOrientation||Z.call(this),this.data={},this.elements={},e=this.elements.boundary=document.createElement("div"),t=this.elements.viewport=document.createElement("div"),this.elements.img=document.createElement("img"),i=this.elements.overlay=document.createElement("div"),this.options.useCanvas?(this.elements.canvas=document.createElement("canvas"),this.elements.preview=this.elements.canvas):this.elements.preview=this.elements.img,m(e,"cr-boundary"),e.setAttribute("aria-dropeffect","none"),r=this.options.boundary.width,a=this.options.boundary.height,d(e,{width:r+(isNaN(r)?"":"px"),height:a+(isNaN(a)?"":"px")}),m(t,"cr-viewport"),s&&m(t,s),d(t,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),t.setAttribute("tabindex",0),m(this.elements.preview,"cr-image"),f(this.elements.preview,{alt:"preview","aria-grabbed":"false"}),m(i,"cr-overlay"),this.element.appendChild(e),e.appendChild(this.elements.preview),e.appendChild(t),e.appendChild(i),m(this.element,"croppie-container"),this.options.customClass&&m(this.element,this.options.customClass),function(){var e,t,i,r,a,s=this,l=!1;function h(e,t){var i=s.elements.preview.getBoundingClientRect(),n=a.y+t,o=a.x+e;s.options.enforceBoundary?(r.top>i.top+t&&r.bottom<i.bottom+t&&(a.y=n),r.left>i.left+e&&r.right<i.right+e&&(a.x=o)):(a.y=n,a.x=o)}function u(e){s.elements.preview.setAttribute("aria-grabbed",e),s.elements.boundary.setAttribute("aria-dropeffect",e?"move":"none")}function c(i){if((void 0===i.button||0===i.button)&&(i.preventDefault(),!l)){if(l=!0,e=i.pageX,t=i.pageY,i.touches){var n=i.touches[0];e=n.pageX,t=n.pageY}u(l),a=y.parse(s.elements.preview),window.addEventListener("mousemove",m),window.addEventListener("touchmove",m),window.addEventListener("mouseup",f),window.addEventListener("touchend",f),document.body.style[o]="none",r=s.elements.viewport.getBoundingClientRect()}}function m(o){o.preventDefault();var r=o.pageX,l=o.pageY;if(o.touches){var u=o.touches[0];r=u.pageX,l=u.pageY}var c=r-e,m=l-t,f={};if("touchmove"===o.type&&o.touches.length>1){var v=o.touches[0],g=o.touches[1],w=Math.sqrt((v.pageX-g.pageX)*(v.pageX-g.pageX)+(v.pageY-g.pageY)*(v.pageY-g.pageY));i||(i=w/s._currentZoom);var y=w/i;return B.call(s,y),void p(s.elements.zoomer)}h(c,m),f[n]=a.toString(),d(s.elements.preview,f),R.call(s),t=l,e=r}function f(){u(l=!1),window.removeEventListener("mousemove",m),window.removeEventListener("touchmove",m),window.removeEventListener("mouseup",f),window.removeEventListener("touchend",f),document.body.style[o]="",_.call(s),X.call(s),i=0}s.elements.overlay.addEventListener("mousedown",c),s.elements.viewport.addEventListener("keydown",function(e){var t=37,l=38,u=39,c=40;if(!e.shiftKey||e.keyCode!==l&&e.keyCode!==c){if(s.options.enableKeyMovement&&e.keyCode>=37&&e.keyCode<=40){e.preventDefault();var p=function(e){switch(e){case t:return[1,0];case l:return[0,1];case u:return[-1,0];case c:return[0,-1]}}(e.keyCode);a=y.parse(s.elements.preview),document.body.style[o]="none",r=s.elements.viewport.getBoundingClientRect(),function(e){var t=e[0],r=e[1],l={};h(t,r),l[n]=a.toString(),d(s.elements.preview,l),R.call(s),document.body.style[o]="",_.call(s),X.call(s),i=0}(p)}}else{var m=0;m=e.keyCode===l?parseFloat(s.elements.zoomer.value,10)+parseFloat(s.elements.zoomer.step,10):parseFloat(s.elements.zoomer.value,10)-parseFloat(s.elements.zoomer.step,10),s.setZoom(m)}}),s.elements.overlay.addEventListener("touchstart",c)}.call(this),this.options.enableZoom&&function(){var e=this,t=e.elements.zoomerWrap=document.createElement("div"),i=e.elements.zoomer=document.createElement("input");function n(){L.call(e,{value:parseFloat(i.value),origin:new b(e.elements.preview),viewportRect:e.elements.viewport.getBoundingClientRect(),transform:y.parse(e.elements.preview)})}function o(t){var i,o;if("ctrl"===e.options.mouseWheelZoom&&!0!==t.ctrlKey)return 0;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0,o=e._currentZoom+i*e._currentZoom,t.preventDefault(),B.call(e,o),n.call(e)}m(t,"cr-slider-wrap"),m(i,"cr-slider"),i.type="range",i.step="0.0001",i.value=1,i.style.display=e.options.showZoomer?"":"none",i.setAttribute("aria-label","zoom"),e.element.appendChild(t),t.appendChild(i),e._currentZoom=1,e.elements.zoomer.addEventListener("input",n),e.elements.zoomer.addEventListener("change",n),e.options.mouseWheelZoom&&(e.elements.boundary.addEventListener("mousewheel",o),e.elements.boundary.addEventListener("DOMMouseScroll",o))}.call(this),this.options.enableResize&&function(){var e,t,i,n,r,a,s,l=this,h=document.createElement("div"),u=!1,c=50;m(h,"cr-resizer"),d(h,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(m(a=document.createElement("div"),"cr-resizer-vertical"),h.appendChild(a));this.options.resizeControls.width&&(m(s=document.createElement("div"),"cr-resizer-horisontal"),h.appendChild(s));function p(a){if((void 0===a.button||0===a.button)&&(a.preventDefault(),!u)){var s=l.elements.overlay.getBoundingClientRect();if(u=!0,t=a.pageX,i=a.pageY,e=-1!==a.currentTarget.className.indexOf("vertical")?"v":"h",n=s.width,r=s.height,a.touches){var h=a.touches[0];t=h.pageX,i=h.pageY}window.addEventListener("mousemove",f),window.addEventListener("touchmove",f),window.addEventListener("mouseup",v),window.addEventListener("touchend",v),document.body.style[o]="none"}}function f(o){var a=o.pageX,s=o.pageY;if(o.preventDefault(),o.touches){var u=o.touches[0];a=u.pageX,s=u.pageY}var p=a-t,m=s-i,f=l.options.viewport.height+m,v=l.options.viewport.width+p;"v"===e&&f>=c&&f<=r?(d(h,{height:f+"px"}),l.options.boundary.height+=m,d(l.elements.boundary,{height:l.options.boundary.height+"px"}),l.options.viewport.height+=m,d(l.elements.viewport,{height:l.options.viewport.height+"px"})):"h"===e&&v>=c&&v<=n&&(d(h,{width:v+"px"}),l.options.boundary.width+=p,d(l.elements.boundary,{width:l.options.boundary.width+"px"}),l.options.viewport.width+=p,d(l.elements.viewport,{width:l.options.viewport.width+"px"})),R.call(l),j.call(l),_.call(l),X.call(l),i=s,t=a}function v(){u=!1,window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v),document.body.style[o]=""}a&&(a.addEventListener("mousedown",p),a.addEventListener("touchstart",p));s&&(s.addEventListener("mousedown",p),s.addEventListener("touchstart",p));this.elements.boundary.appendChild(h)}.call(this)}function Z(){return this.options.enableExif&&window.EXIF}function B(e){if(this.options.enableZoom){var t=this.elements.zoomer,i=k(e,4);t.value=Math.max(t.min,Math.min(t.max,i))}}function L(e){var t=this,o=e?e.transform:y.parse(t.elements.preview),r=e?e.viewportRect:t.elements.viewport.getBoundingClientRect(),a=e?e.origin:new b(t.elements.preview);function s(){var e={};e[n]=o.toString(),e[i]=a.toString(),d(t.elements.preview,e)}if(t._currentZoom=e?e.value:t._currentZoom,o.scale=t._currentZoom,t.elements.zoomer.setAttribute("aria-valuenow",t._currentZoom),s(),t.options.enforceBoundary){var l=function(e){var t=this._currentZoom,i=e.width,n=e.height,o=this.elements.boundary.clientWidth/2,r=this.elements.boundary.clientHeight/2,a=this.elements.preview.getBoundingClientRect(),s=a.width,l=a.height,h=i/2,u=n/2,c=-1*(h/t-o),p=-1*(u/t-r),d=1/t*h,m=1/t*u;return{translate:{maxX:c,minX:c-(s*(1/t)-i*(1/t)),maxY:p,minY:p-(l*(1/t)-n*(1/t))},origin:{maxX:s*(1/t)-d,minX:d,maxY:l*(1/t)-m,minY:m}}}.call(t,r),h=l.translate,u=l.origin;o.x>=h.maxX&&(a.x=u.minX,o.x=h.maxX),o.x<=h.minX&&(a.x=u.maxX,o.x=h.minX),o.y>=h.maxY&&(a.y=u.minY,o.y=h.maxY),o.y<=h.minY&&(a.y=u.maxY,o.y=h.minY)}s(),W.call(t),X.call(t)}function _(){var e=this._currentZoom,t=this.elements.preview.getBoundingClientRect(),o=this.elements.viewport.getBoundingClientRect(),r=y.parse(this.elements.preview.style[n]),a=new b(this.elements.preview),s=o.top-t.top+o.height/2,l=o.left-t.left+o.width/2,h={},u={};h.y=s/e,h.x=l/e,u.y=(h.y-a.y)*(1-e),u.x=(h.x-a.x)*(1-e),r.x-=u.x,r.y-=u.y;var c={};c[i]=h.x+"px "+h.y+"px",c[n]=r.toString(),d(this.elements.preview,c)}function R(){if(this.elements){var e=this.elements.boundary.getBoundingClientRect(),t=this.elements.preview.getBoundingClientRect();d(this.elements.overlay,{width:t.width+"px",height:t.height+"px",top:t.top-e.top+"px",left:t.left-e.left+"px"})}}b.prototype.toString=function(){return this.x+"px "+this.y+"px"};var z,M,I,O,W=(z=R,M=500,function(){var e=this,t=arguments,i=I&&!O;clearTimeout(O),O=setTimeout(function(){O=null,I||z.apply(e,t)},M),i&&z.apply(e,t)});function X(){var e,t=this.get();Y.call(this)&&(this.options.update.call(this,t),this.$&&"undefined"==typeof Prototype?this.$(this.element).trigger("update.croppie",t):(window.CustomEvent?e=new CustomEvent("update",{detail:t}):(e=document.createEvent("CustomEvent")).initCustomEvent("update",!0,!0,t),this.element.dispatchEvent(e)))}function Y(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function F(){var e,t={},o=this.elements.preview,r=new y(0,0,1),a=new b;Y.call(this)&&!this.data.bound&&(this.data.bound=!0,t[n]=r.toString(),t[i]=a.toString(),t.opacity=1,d(o,t),e=this.elements.preview.getBoundingClientRect(),this._originalImageWidth=e.width,this._originalImageHeight=e.height,this.data.orientation=x(this.elements.img),this.options.enableZoom?j.call(this,!0):this._currentZoom=1,r.scale=this._currentZoom,t[n]=r.toString(),d(o,t),this.data.points.length?function(e){if(4!==e.length)throw"Croppie - Invalid number of points supplied: "+e;var t=e[2]-e[0],o=this.elements.viewport.getBoundingClientRect(),r=this.elements.boundary.getBoundingClientRect(),a={left:o.left-r.left,top:o.top-r.top},s=o.width/t,l=e[1],h=e[0],u=-1*e[1]+a.top,c=-1*e[0]+a.left,p={};p[i]=h+"px "+l+"px",p[n]=new y(c,u,s).toString(),d(this.elements.preview,p),B.call(this,s),this._currentZoom=s}.call(this,this.data.points):function(){var e=this.elements.preview.getBoundingClientRect(),t=this.elements.viewport.getBoundingClientRect(),i=this.elements.boundary.getBoundingClientRect(),o=t.left-i.left,r=t.top-i.top,a=o-(e.width-t.width)/2,s=r-(e.height-t.height)/2,l=new y(a,s,this._currentZoom);d(this.elements.preview,n,l.toString())}.call(this),_.call(this),R.call(this))}function j(e){var t,i,n,o,r=0,a=this.options.maxZoom||1.5,s=this.elements.zoomer,l=parseFloat(s.value),h=this.elements.boundary.getBoundingClientRect(),u=g(this.elements.img,this.data.orientation),c=this.elements.viewport.getBoundingClientRect();this.options.enforceBoundary&&(n=c.width/u.width,o=c.height/u.height,r=Math.max(n,o)),r>=a&&(a=r+1),s.min=k(r,4),s.max=k(a,4),!e&&(l<s.min||l>s.max)?B.call(this,l<s.min?s.min:s.max):e&&(i=Math.max(h.width/u.width,h.height/u.height),t=null!==this.data.boundZoom?this.data.boundZoom:i,B.call(this,t)),p(s)}function N(e){var t=e.points,i=v(t[0]),n=v(t[1]),o=v(t[2])-i,r=v(t[3])-n,a=e.circle,s=document.createElement("canvas"),l=s.getContext("2d"),h=e.outputWidth||o,u=e.outputHeight||r;e.outputWidth&&e.outputHeight;return s.width=h,s.height=u,e.backgroundColor&&(l.fillStyle=e.backgroundColor,l.fillRect(0,0,h,u)),!1!==this.options.enforceBoundary&&(o=Math.min(o,this._originalImageWidth),r=Math.min(r,this._originalImageHeight)),l.drawImage(this.elements.preview,i,n,o,r,0,0,h,u),a&&(l.fillStyle="#fff",l.globalCompositeOperation="destination-in",l.beginPath(),l.arc(s.width/2,s.height/2,s.width/2,0,2*Math.PI,!0),l.closePath(),l.fill()),s}function S(e,t){var i,n,o,r,a=this,s=[],l=null,h=Z.call(a);if("string"==typeof e)i=e,e={};else if(Array.isArray(e))s=e.slice();else{if(void 0===e&&a.data.url)return F.call(a),X.call(a),null;i=e.url,s=e.points||[],l=void 0===e.zoom?null:e.zoom}return a.data.bound=!1,a.data.url=i||a.data.url,a.data.boundZoom=l,(n=i,o=h,r=new Image,r.style.opacity=0,new Promise(function(e){function t(){r.style.opacity=1,setTimeout(function(){e(r)},1)}r.removeAttribute("crossOrigin"),n.match(/^https?:\/\/|^\/\//)&&r.setAttribute("crossOrigin","anonymous"),r.onload=function(){o?EXIF.getData(r,function(){t()}):t()},r.src=n})).then(function(i){if(function(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){e.classList.add(t)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}.call(a,i),s.length)a.options.relative&&(s=[s[0]*i.naturalWidth/100,s[1]*i.naturalHeight/100,s[2]*i.naturalWidth/100,s[3]*i.naturalHeight/100]);else{var n,o,r=g(i),l=a.elements.viewport.getBoundingClientRect(),h=l.width/l.height;r.width/r.height>h?n=(o=r.height)*h:(n=r.width,o=r.height/h);var u=(r.width-n)/2,c=(r.height-o)/2,p=u+n,d=c+o;a.data.points=[u,c,p,d]}a.data.points=s.map(function(e){return parseFloat(e)}),a.options.useCanvas&&function(e){var t=this.elements.canvas,i=this.elements.img,n=t.getContext("2d"),o=Z.call(this);e=this.options.enableOrientation&&e,n.clearRect(0,0,t.width,t.height),t.width=i.width,t.height=i.height,o&&!e?C(t,i,v(x(i)||0)):e&&C(t,i,e)}.call(a,e.orientation||1),F.call(a),X.call(a),t&&t()}).catch(function(e){console.error("Croppie:"+e)})}function k(e,t){return parseFloat(e).toFixed(t||0)}function A(){var e=this.elements.preview.getBoundingClientRect(),t=this.elements.viewport.getBoundingClientRect(),i=t.left-e.left,n=t.top-e.top,o=(t.width-this.elements.viewport.offsetWidth)/2,r=(t.height-this.elements.viewport.offsetHeight)/2,a=i+this.elements.viewport.offsetWidth+o,s=n+this.elements.viewport.offsetHeight+r,l=this._currentZoom;(l===1/0||isNaN(l))&&(l=1);var h=this.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(h,i/l),n=Math.max(h,n/l),a=Math.max(h,a/l),s=Math.max(h,s/l),{points:[k(i),k(n),k(a),k(s)],zoom:l,orientation:this.data.orientation}}var H={type:"canvas",format:"png",quality:1},P=["jpeg","webp","png"];function D(e){var t=this,i=A.call(t),n=u(c(H),c(e)),o="string"==typeof e?e:n.type||"base64",r=n.size||"viewport",a=n.format,s=n.quality,l=n.backgroundColor,h="boolean"==typeof n.circle?n.circle:"circle"===t.options.viewport.type,p=t.elements.viewport.getBoundingClientRect(),f=p.width/p.height;return"viewport"===r?(i.outputWidth=p.width,i.outputHeight=p.height):"object"==typeof r&&(r.width&&r.height?(i.outputWidth=r.width,i.outputHeight=r.height):r.width?(i.outputWidth=r.width,i.outputHeight=r.width/f):r.height&&(i.outputWidth=r.height*f,i.outputHeight=r.height)),P.indexOf(a)>-1&&(i.format="image/"+a,i.quality=s),i.circle=h,i.url=t.data.url,i.backgroundColor=l,new Promise(function(e,n){switch(o.toLowerCase()){case"rawcanvas":e(N.call(t,i));break;case"canvas":case"base64":e(function(e){return N.call(this,e).toDataURL(e.format,e.quality)}.call(t,i));break;case"blob":(function(e){var t=this;return new Promise(function(i,n){N.call(t,e).toBlob(function(e){i(e)},e.format,e.quality)})}).call(t,i).then(e);break;default:e(function(e){var t=e.points,i=document.createElement("div"),n=document.createElement("img"),o=t[2]-t[0],r=t[3]-t[1];return m(i,"croppie-result"),i.appendChild(n),d(n,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),n.src=e.url,d(i,{width:o+"px",height:r+"px"}),i}.call(t,i))}})}function T(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t,i,n,o,r,a=this.elements.canvas;this.data.orientation=(t=this.data.orientation,i=e,n=s.indexOf(t)>-1?s:l,o=n.indexOf(t),r=i/90%n.length,n[(n.length+o+r%n.length)%n.length]),C(a,this.elements.img,this.data.orientation),j.call(this),L.call(this),copy=null}if(window.jQuery){var q=window.jQuery;q.fn.croppie=function(e){if("string"===typeof e){var t=Array.prototype.slice.call(arguments,1),i=q(this).data("croppie");return"get"===e?i.get():"result"===e?i.result.apply(i,t):"bind"===e?i.bind.apply(i,t):this.each(function(){var i=q(this).data("croppie");if(i){var n=i[e];if(!q.isFunction(n))throw"Croppie "+e+" method not found";n.apply(i,t),"destroy"===e&&q(this).removeData("croppie")}})}return this.each(function(){var t=new V(this,e);t.$=q,q(this).data("croppie",t)})}}function V(e,t){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=e,this.options=u(c(V.defaults),t),"img"===this.element.tagName.toLowerCase()){var i=this.element;m(i,"cr-original-image"),f(i,{"aria-hidden":"true",alt:""});var n=document.createElement("div");this.element.parentNode.appendChild(n),n.appendChild(i),this.element=n,this.options.url=this.options.url||i.src}if(E.call(this),this.options.url){var o={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,S.call(this,o)}}V.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},V.globals={translate:"translate3d"},u(V.prototype,{bind:function(e,t){return S.call(this,e,t)},get:function(){var e=A.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return D.call(this,e)},refresh:function(){return function(){F.call(this)}.call(this)},setZoom:function(e){B.call(this,e),p(this.elements.zoomer)},rotate:function(e){T.call(this,e)},destroy:function(){return function(){var e,t;this.element.removeChild(this.elements.boundary),e=this.element,t="croppie-container",e.classList?e.classList.remove(t):e.className=e.className.replace(t,""),this.options.enableZoom&&this.element.removeChild(this.elements.zoomerWrap),delete this.elements}.call(this)}}),t.Croppie=window.Croppie=V},"string"!=typeof i.nodeName?o(i):o(n.commonJsStrict={})}(i={exports:{}},i.exports),i.exports),o={name:"VueCroppie",render:function(e){return e("div",{class:this.customClass,ref:"croppieContainer",id:"croppieContainer"})},props:{boundary:Object,customClass:String,enableExif:Boolean,enableOrientation:{type:Boolean,default:!0},enableResize:{type:Boolean,default:!0},enableZoom:{type:Boolean,default:!0},enforceBoundary:{type:Boolean,default:!0},mouseWheelZoom:{type:[Boolean,String],default:!0},showZoomer:{type:Boolean,default:!0},croppieInitialized:{type:Function,default:function(){}},viewport:{type:Object,default:function(){return{width:200,height:200,type:"square"}}},minZoom:Number,maxZoom:Number},mounted:function(){this.initCroppie()},data:function(){return{croppie:null}},methods:{initCroppie:function(){var e=this,t=this.$refs.croppieContainer,i={enableExif:this.enableExif,enableOrientation:this.enableOrientation,enableZoom:this.enableZoom,enableResize:this.enableResize,enforceBoundary:this.enforceBoundary,mouseWheelZoom:this.mouseWheelZoom,viewport:this.viewport,showZoomer:this.showZoomer,minZoom:this.minZoom,maxZoom:this.maxZoom};this.boundary&&(i.boundary=this.boundary),t.addEventListener("update",function(t){e.$emit("update",t.detail)}),this.croppie=new n(t,i),this.croppieInitialized()},bind:function(e){return this.croppie.bind(e)},destroy:function(){this.croppie.destroy()},get:function(e){if(!e)return this.croppie.get();e(this.croppie.get())},rotate:function(e){this.croppie.rotate(e)},setZoom:function(e){this.croppie.setZoom(e)},result:function(e,t){var i=this;return e||(e={type:"base64"}),this.croppie.result(e).then(function(e){return t?t(e):i.$emit("result",e),e})},refresh:function(){this.croppie.destroy(),this.initCroppie()}}},r={install:function(e,t){e.component(o.name,o)}};window&&window.Vue&&Vue.use(r),e.default=r,e.VueCroppieComponent=o,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=vue-croppie.min.js.map
